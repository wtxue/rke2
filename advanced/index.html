
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/favicon-32x32.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Advanced Options and Configuration - RKE2 - Rancher's Next Generation Kubernetes Distribution</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f72e892.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Work+Sans:300,400,400i,700%7C&display=fallback">
        <style>body,input{font-family:"Work Sans",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#advanced-options-and-configuration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="RKE2 - Rancher&#39;s Next Generation Kubernetes Distribution" class="md-header-nav__button md-logo" aria-label="RKE2 - Rancher's Next Generation Kubernetes Distribution">
      
  <img src="../assets/logo-stacked-white-rke2.svg" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            RKE2 - Rancher's Next Generation Kubernetes Distribution
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Advanced Options and Configuration
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/rancher/rke2/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="RKE2 - Rancher&#39;s Next Generation Kubernetes Distribution" class="md-nav__button md-logo" aria-label="RKE2 - Rancher's Next Generation Kubernetes Distribution">
      
  <img src="../assets/logo-stacked-white-rke2.svg" alt="logo">

    </a>
    RKE2 - Rancher's Next Generation Kubernetes Distribution
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/rancher/rke2/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Installation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Installation" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../install/quickstart/" class="md-nav__link">
      Quick Start
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/requirements/" class="md-nav__link">
      Requirements
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/ha/" class="md-nav__link">
      High Availability
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      Install Options
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Install Options" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        <span class="md-nav__icon md-icon"></span>
        Install Options
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../install/install_options/install_options/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/install_options/server_config/" class="md-nav__link">
      Server Configuration Reference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/install_options/agent_config/" class="md-nav__link">
      Agent Configuration Reference
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/methods/" class="md-nav__link">
      Installation Methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/network_options/" class="md-nav__link">
      Network Options
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/containerd_registry_configuration/" class="md-nav__link">
      Containerd Registry Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/airgap/" class="md-nav__link">
      Air-Gap Install
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install/uninstall/" class="md-nav__link">
      Uninstall
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Upgrades
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Upgrades" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Upgrades
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../upgrade/upgrade/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../upgrade/basic_upgrade/" class="md-nav__link">
      Upgrade Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../upgrade/automated_upgrade/" class="md-nav__link">
      Automated Upgrades
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Security
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Security" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Security
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../security/hardening_guide/" class="md-nav__link">
      CIS Hardening Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../security/cis_self_assessment/" class="md-nav__link">
      CIS Self-Assessment Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../security/fips_support/" class="md-nav__link">
      FIPS 140-2 Enablement
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../security/policies/" class="md-nav__link">
      Default Policy Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../security/selinux/" class="md-nav__link">
      SELinux
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Architecture
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Architecture" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Architecture
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../architecture/architecture/" class="md-nav__link">
      Anatomy of a Next Generation Kubernetes Distribution
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../cluster_access/" class="md-nav__link">
      Cluster Access
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../backup_restore/" class="md-nav__link">
      Etcd Backup and Restore
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../networking/" class="md-nav__link">
      Networking
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../helm/" class="md-nav__link">
      Helm Integration
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Advanced Options and Configuration
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Advanced Options and Configuration
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#certificate-rotation" class="md-nav__link">
    Certificate Rotation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-deploying-manifests" class="md-nav__link">
    Auto-Deploying Manifests
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-containerd" class="md-nav__link">
    Configuring containerd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secrets-encryption-config" class="md-nav__link">
    Secrets Encryption Config
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#node-labels-and-taints" class="md-nav__link">
    Node Labels and Taints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-the-server-with-the-installation-script" class="md-nav__link">
    Starting the Server with the Installation Script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disabling-server-charts" class="md-nav__link">
    Disabling Server Charts
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../known_issues/" class="md-nav__link">
      Known Issues and Limitations
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#certificate-rotation" class="md-nav__link">
    Certificate Rotation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auto-deploying-manifests" class="md-nav__link">
    Auto-Deploying Manifests
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-containerd" class="md-nav__link">
    Configuring containerd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#secrets-encryption-config" class="md-nav__link">
    Secrets Encryption Config
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#node-labels-and-taints" class="md-nav__link">
    Node Labels and Taints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#starting-the-server-with-the-installation-script" class="md-nav__link">
    Starting the Server with the Installation Script
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#disabling-server-charts" class="md-nav__link">
    Disabling Server Charts
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/rancher/rke2/edit/master/docs/advanced.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="advanced-options-and-configuration">Advanced Options and Configuration<a class="headerlink" href="#advanced-options-and-configuration" title="Permanent link">&para;</a></h1>
<p>This section contains advanced information describing the different ways you can run and manage RKE2.</p>
<h2 id="certificate-rotation">Certificate Rotation<a class="headerlink" href="#certificate-rotation" title="Permanent link">&para;</a></h2>
<p>By default, certificates in RKE2 expire in 12 months.</p>
<p>If the certificates are expired or have fewer than 90 days remaining before they expire, the certificates are rotated when RKE2 is restarted.</p>
<h2 id="auto-deploying-manifests">Auto-Deploying Manifests<a class="headerlink" href="#auto-deploying-manifests" title="Permanent link">&para;</a></h2>
<p>Any file found in <code>/var/lib/rancher/rke2/server/manifests</code> will automatically be deployed to Kubernetes in a manner similar to <code>kubectl apply</code>.</p>
<p>For information about deploying Helm charts using the manifests directory, refer to the section about <a href="../helm/">Helm.</a></p>
<h2 id="configuring-containerd">Configuring containerd<a class="headerlink" href="#configuring-containerd" title="Permanent link">&para;</a></h2>
<p>RKE2 will generate the <code>config.toml</code> for containerd in <code>/var/lib/rancher/rke2/agent/etc/containerd/config.toml</code>.</p>
<p>For advanced customization of this file you can create another file called <code>config.toml.tmpl</code> in the same directory and it will be used instead.</p>
<p>The <code>config.toml.tmpl</code> will be treated as a Go template file, and the <code>config.Node</code> structure is being passed to the template. See <a href="https://github.com/rancher/k3s/blob/master/pkg/agent/templates/templates.go#L16-L32">this template</a> for an example of how to use the structure to customize the configuration file.</p>
<h2 id="secrets-encryption-config">Secrets Encryption Config<a class="headerlink" href="#secrets-encryption-config" title="Permanent link">&para;</a></h2>
<p>RKE2 supports encrypting Secrets at rest, and will do the following automatically:</p>
<ul>
<li>Generate an AES-CBC key</li>
<li>Generate an encryption config file with the generated key:</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="p p-Indicator">{</span>
  <span class="s">&quot;kind&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;EncryptionConfiguration&quot;</span><span class="p p-Indicator">,</span>
  <span class="s">&quot;apiVersion&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;apiserver.config.k8s.io/v1&quot;</span><span class="p p-Indicator">,</span>
  <span class="s">&quot;resources&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
    <span class="p p-Indicator">{</span>
      <span class="s">&quot;resources&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
        <span class="s">&quot;secrets&quot;</span>
      <span class="p p-Indicator">],</span>
      <span class="s">&quot;providers&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
        <span class="p p-Indicator">{</span>
          <span class="s">&quot;aescbc&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{</span>
            <span class="s">&quot;keys&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">[</span>
              <span class="p p-Indicator">{</span>
                <span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;aescbckey&quot;</span><span class="p p-Indicator">,</span>
                <span class="s">&quot;secret&quot;</span><span class="p p-Indicator">:</span> <span class="s">&quot;xxxxxxxxxxxxxxxxxxx&quot;</span>
              <span class="p p-Indicator">}</span>
            <span class="p p-Indicator">]</span>
          <span class="p p-Indicator">}</span>
        <span class="p p-Indicator">},</span>
        <span class="p p-Indicator">{</span>
          <span class="s">&quot;identity&quot;</span><span class="p p-Indicator">:</span> <span class="p p-Indicator">{}</span>
        <span class="p p-Indicator">}</span>
      <span class="p p-Indicator">]</span>
    <span class="p p-Indicator">}</span>
  <span class="p p-Indicator">]</span>
<span class="p p-Indicator">}</span>
</code></pre></div>

<ul>
<li>Pass the config to the Kubernetes APIServer as encryption-provider-config</li>
</ul>
<p>Once enabled any created secret will be encrypted with this key. Note that if you disable encryption then any encrypted secrets will not be readable until you enable encryption again using the same key.</p>
<h2 id="node-labels-and-taints">Node Labels and Taints<a class="headerlink" href="#node-labels-and-taints" title="Permanent link">&para;</a></h2>
<p>RKE2 agents can be configured with the options <code>node-label</code> and <code>node-taint</code> which adds a label and taint to the kubelet. The two options only add labels and/or taints at registration time, and can only be added once and not removed after that through rke2 commands.</p>
<p>If you want to change node labels and taints after node registration you should use <code>kubectl</code>. Refer to the official Kubernetes documentation for details on how to add <a href="https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/">taints</a> and <a href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes/#add-a-label-to-a-node">node labels</a>.</p>
<h2 id="starting-the-server-with-the-installation-script">Starting the Server with the Installation Script<a class="headerlink" href="#starting-the-server-with-the-installation-script" title="Permanent link">&para;</a></h2>
<p>The installation script provides units for systemd, but does not enable or start the service by default.</p>
<p>When running with systemd, logs will be created in <code>/var/log/syslog</code> and viewed using <code>journalctl -u rke2-server</code> or <code>journalctl -u rke2-agent</code>.</p>
<p>An example of installing with the install script:</p>
<div class="codehilite"><pre><span></span><code>curl -sfL https://get.rke2.io <span class="p">|</span> sh -
systemctl <span class="nb">enable</span> rke2-server
systemctl start rke2-server
</code></pre></div>

<h2 id="disabling-server-charts">Disabling Server Charts<a class="headerlink" href="#disabling-server-charts" title="Permanent link">&para;</a></h2>
<p>The server charts bundled with <code>rke2</code> deployed during cluster bootstrapping can be disabled and replaced with alternatives.  A common use case is replacing the bundled <code>rke2-ingress-nginx</code> chart with an alternative.</p>
<p>To disable any of the bundled system charts, set the <code>disable</code> parameter in the config file before bootstrapping.  The full list of system charts to disable is below:</p>
<ul>
<li><code>rke2-canal</code></li>
<li><code>rke2-coredns</code></li>
<li><code>rke2-ingress-nginx</code></li>
<li><code>rke2-kube-proxy</code></li>
<li><code>rke2-metrics-server</code></li>
</ul>
<p>Note that it is the cluster operator's responsibility to ensure that components are disabled or replaced with care, as the server charts play important roles in cluster operability.  Refer to the <a href="../architecture/architecture/#server-charts">architecture overview</a> for more information on the individual system charts role within the cluster.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../helm/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Helm Integration
              </div>
            </div>
          </a>
        
        
          <a href="../known_issues/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Known Issues and Limitations
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>